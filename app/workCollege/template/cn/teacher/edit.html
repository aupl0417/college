<link href="{_TEMP_PUBLIC_}/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet">
<script src="{_TEMP_PUBLIC_}/plugins/fancybox/source/jquery.fancybox.pack.js" type="text/javascript"></script>
<div class="portlet-body">
	讲师信息
</div>

<form action="/teacher/edit.json" class="form-horizontal form-row-seperated" id="transfer_detail">
	<div class="form-body clearfix">
		<table class="table responsive-form-table" id="peopleList">
			<tbody>
			<replace value="id|username|trueName|email|mobile|branchName|source|te_sex|te_birthday|te_photo|tl_name|te_description|teacherLevel|branchList|gradeList|te_workExperience|te_courseReward|te_IDNum">
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">教师编号</th>
					<td class="col-sm-12 col-md-10 borderd">{id}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">来源</th>
					<td class="col-sm-12 col-md-10 borderd">{source}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">会员名</th>
					<td class="col-sm-12 col-md-10 borderd">{username}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">讲师姓名</th>
					<td class="col-sm-12 col-md-10 borderd">{trueName}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">性别</th>
					<td class="col-sm-12 col-md-10 borderd">{te_sex}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">讲师状态</th>
					<td class="col-sm-12 col-md-10 borderd"><input type='radio' name='isLeave' checked='checked' value='0'>在职　　<input type='radio' name='isLeave' value='1'>离职</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">生日</th>
					<td class="col-sm-12 col-md-10 borderd">{te_birthday}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">联系手机</th>
					<td class="col-sm-12 col-md-10 borderd">{mobile}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">联系邮箱</th>
					<td class="col-sm-12 col-md-10 borderd">{email}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">身份证号码</th>
					<td class="col-sm-12 col-md-10 borderd">{te_IDNum}</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">简介</th>
					<td class="col-sm-12 col-md-10 borderd">
						<textarea class="form-control autosizeme" name="description" rows="3">{te_description}</textarea>
					</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">讲师等级</th>
					<td class="col-sm-12 col-md-10 borderd">
						<select name='level' class="form-control">
							<option value=''>--请选择--</option>
							{teacherLevel}
						</select>
					</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">从业经历</th>
					<td class="col-sm-12 col-md-10 borderd">{te_workExperience}</td>
				</tr>
				<!-- <tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">加入时间</th>
					<td class="col-sm-12 col-md-10 borderd">2012-11-12</td>
				</tr> -->
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">课时薪酬（￥）</th>
					<td class="col-sm-12 col-md-10 borderd"><input type="text" name="courseReward" class="form-control" value="{te_courseReward}"></td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">授课类型</th>
					<td class="col-sm-12 col-md-10 borderd">
						<select name='teachGrade' class="form-control">
							<option value=''>--请选择--</option>
							{gradeList}
						</select>
					</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">所属学院</th>
					<td class="col-sm-12 col-md-10 borderd">
						<select name='branchId' class="form-control">
							<option value=''>--请选择--</option>
							{branchList}
						</select>
					</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd">上传讲师照片</th>
					<td class="col-sm-12 col-md-10 borderd">
						<div class="form-group form-md-line-input"><!--行 begin-->
							<div class="col-md-10">
								<div class="row">
									<div class="col-sm-12 col-md-4 hiduploader">
										<div data-provides="fileinput" class="fileinput">
											<div class="thumbnail">
												<img alt="讲师照片" src="{te_photo}" class="img-reponsetive">
												<input type="hidden" value="" name="logo">
											</div>
										</div>
										<div class="input-group modalUpload" data-savename="1" data-url="/public/uploadPhoto.json">
								<span class="input-group-btn">
									<button type="button" class="btn blue start btn-block">
										<i class="fa fa-upload"></i>
										讲师照片
									</button>
								</span>
										</div>
									</div>
								</div> <!--营业执照上传end-->
							</div>
						</div><!--行end-->
					</td>
				</tr>
				<tr class="table-row">
					<th class="hidden-sm col-md-2 borderd"></th>
					<td class="col-sm-12 col-md-10 borderd">
						<input type="hidden" name="id" value="{id}">
						<button type="submit" class="btn blue"><i class="fa fa-check"></i> 确认 </button>
						<button type="button" data-dismiss="modal" class="btn default"><i class="fa fa-rotate-left"></i> 关闭</button>
					</td>
				</tr>
			</replace>
			</tbody>
		</table>
	</div>
</form>

<script>+
	$(function () {
		$('#transfer_detail').handleForm(
			{
				rules: {
					teacherLevel:{
						required: true
					},
					branchId:{
						required: true
					},
					teachGrade:{
						required: true
					},
				},
				messages: {
					teacherLevel:{
						required: '请选择讲师等级'
					},
					branchId:{
						required: '请选择学院'
					},
					teachGrade:{
						required: '请选择授课类型'
					},
				},
				closest: 'td',
				ass: {

				}
			},
			function(data, statusText){
				if(data.id == '1001'){
					bootbox.alert('操作成功', function() {
						$('#temp-modal-power').modal('hide');
						Grid.getDataTable().ajax.reload(null, false);
					});
				}else{
					Global.alert( {
						"container": "#transfer_detail",
						"place": "prepend",
						"type": "warning",
						"message": data.info,
						"close": true,
						"reset": true,
						"focus": true,
						"closeInSeconds": "0",
						"icon": "warning"
					});
				}

			}
		);
	});

	function show_reson(obj){
		if(2 == $(obj).val()){
			$('#reason').show();
		}else{
			$('#reason').hide();
		}
	}

var flowModalUpload = function() {
	$('.modalUpload').each(function(i) {
		$(this).handleUpload(function(data) {
			if (data.status == 'success') {
				var fileinput = $(".modalUpload:eq(" + i + ")").prev('.fileinput');
				$("input[type='hidden']", fileinput).val(data.savename);
				$('.thumbnail img', fileinput).prop('src', data.filename + '?r=' + Math.random());
				$('.thumbnail a.fancybox-button', fileinput).prop('href', data.filename + '?r=' + Math.random());
			} else {
				return false;
			}
		});
	});
};

flowModalUpload();
var isLeave = '<replace value="te_isLeave">{te_isLeave}</replace>';
$("input[name='isLeave']").each(function(){
	if($(this).val() == isLeave){
		$(this).attr('checked', true);
	}else {
		$(this).attr('checked', false);
	}
});

</script>